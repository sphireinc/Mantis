<!-- Code generated by gomarkdoc. DO NOT EDIT -->

[![Go Report Card](https://goreportcard.com/badge/github.com/sphireinc/mantis)](https://goreportcard.com/report/github.com/sphireinc/mantis)
[![Go Reference](https://pkg.go.dev/badge/github.com/sphireinc/mantis.svg)](https://pkg.go.dev/github.com/sphireinc/mantis)



# cache

```go
import "github.com/sphireinc/mantis/cache"
```

## Index

- [Constants](<#constants>)
- [func filename\(key string\) string](<#filename>)
- [func hash\(key string\) string](<#hash>)
- [func newTmpDir\(\) string](<#newTmpDir>)
- [type BigCache](<#BigCache>)
  - [func \(b \*BigCache\) Init\(\) error](<#BigCache.Init>)
- [type DiskCache](<#DiskCache>)
  - [func New\(\) \*DiskCache](<#New>)
  - [func \(D \*DiskCache\) Get\(key string\) \(any, error\)](<#DiskCache.Get>)
  - [func \(D \*DiskCache\) Set\(key string, data any\) error](<#DiskCache.Set>)
  - [func \(D \*DiskCache\) newTmpFile\(key string\) \*os.File](<#DiskCache.newTmpFile>)
- [type MemCache](<#MemCache>)
  - [func NewMemCache\(algorithm memory.Algorithm, capacity int, refreshKey string, cacheTime time.Duration\) MemCache](<#NewMemCache>)
  - [func \(m \*MemCache\) Init\(\) error](<#MemCache.Init>)
  - [func \(m \*MemCache\) String\(\) string](<#MemCache.String>)
- [type Memory](<#Memory>)
  - [func NewMemoryCache\(capacity int64, expiry string\) \*Memory](<#NewMemoryCache>)
  - [func \(m \*Memory\) Get\(key uint64\) \(any, bool\)](<#Memory.Get>)
  - [func \(m \*Memory\) Release\(key uint64\)](<#Memory.Release>)
  - [func \(m \*Memory\) Set\(key uint64, value any, expiration time.Time\)](<#Memory.Set>)
  - [func \(m \*Memory\) checkExpireAndUpdate\(key uint64, toStore item\) int](<#Memory.checkExpireAndUpdate>)
  - [func \(m \*Memory\) evict\(\)](<#Memory.evict>)
  - [func \(m \*Memory\) triggerEvict\(\)](<#Memory.triggerEvict>)
- [type diskCache](<#diskCache>)
- [type item](<#item>)
- [type memoryConfig](<#memoryConfig>)


## Constants

<a name="RELEASED"></a>RELEASED is a status enum for a released item UPDATED is a status enum for an updated value in an existing kv item CREATED is a status enum for a created kv item NOOP is a status for no operation

```go
const (
    RELEASED = iota
    UPDATED
    CREATED
    NOOP
)
```

<a name="filename"></a>
## func [filename](<https://github.com/sphireinc/mantis/blob/master/cache/diskcache.go#L49>)

```go
func filename(key string) string
```



<a name="hash"></a>
## func [hash](<https://github.com/sphireinc/mantis/blob/master/cache/diskcache.go#L43>)

```go
func hash(key string) string
```



<a name="newTmpDir"></a>
## func [newTmpDir](<https://github.com/sphireinc/mantis/blob/master/cache/diskcache.go#L32>)

```go
func newTmpDir() string
```



<a name="BigCache"></a>
## type [BigCache](<https://github.com/sphireinc/mantis/blob/master/cache/bigcache.go#L8-L11>)

BigCache primary struct with bigcache pointer and config

```go
type BigCache struct {
    Cache  *bigcache.BigCache
    Config bigcache.Config
}
```

<a name="BigCache.Init"></a>
### func \(\*BigCache\) [Init](<https://github.com/sphireinc/mantis/blob/master/cache/bigcache.go#L14>)

```go
func (b *BigCache) Init() error
```

Init creates a new Allegro BigCache based on b.Config

<a name="DiskCache"></a>
## type [DiskCache](<https://github.com/sphireinc/mantis/blob/master/cache/diskcache.go#L20-L23>)

DiskCache primary struct with an array of diskCache \(key:filename\) and the primary directory

```go
type DiskCache struct {
    data      []diskCache
    directory string
}
```

<a name="New"></a>
### func [New](<https://github.com/sphireinc/mantis/blob/master/cache/diskcache.go#L26>)

```go
func New() *DiskCache
```

New creates a new DiskCache using the tmp directory

<a name="DiskCache.Get"></a>
### func \(\*DiskCache\) [Get](<https://github.com/sphireinc/mantis/blob/master/cache/diskcache.go#L87>)

```go
func (D *DiskCache) Get(key string) (any, error)
```

Get the data pointed to by a key

<a name="DiskCache.Set"></a>
### func \(\*DiskCache\) [Set](<https://github.com/sphireinc/mantis/blob/master/cache/diskcache.go#L65>)

```go
func (D *DiskCache) Set(key string, data any) error
```

Set some data to a given key

<a name="DiskCache.newTmpFile"></a>
### func \(\*DiskCache\) [newTmpFile](<https://github.com/sphireinc/mantis/blob/master/cache/diskcache.go#L53>)

```go
func (D *DiskCache) newTmpFile(key string) *os.File
```



<a name="MemCache"></a>
## type [MemCache](<https://github.com/sphireinc/mantis/blob/master/cache/memcache.go#L12-L18>)

MemCache primary struct for victorspringers http\-cache

```go
type MemCache struct {
    Client       *cache.Client
    Algorithm    memory.Algorithm
    Capacity     int
    RefreshKey   string
    memCacheTime time.Duration
}
```

<a name="NewMemCache"></a>
### func [NewMemCache](<https://github.com/sphireinc/mantis/blob/master/cache/memcache.go#L29>)

```go
func NewMemCache(algorithm memory.Algorithm, capacity int, refreshKey string, cacheTime time.Duration) MemCache
```

NewMemCache creates a new MemCache instance

<a name="MemCache.Init"></a>
### func \(\*MemCache\) [Init](<https://github.com/sphireinc/mantis/blob/master/cache/memcache.go#L39>)

```go
func (m *MemCache) Init() error
```

Init starts our in\-memory cache.

<a name="MemCache.String"></a>
### func \(\*MemCache\) [String](<https://github.com/sphireinc/mantis/blob/master/cache/memcache.go#L20>)

```go
func (m *MemCache) String() string
```



<a name="Memory"></a>
## type [Memory](<https://github.com/sphireinc/mantis/blob/master/cache/memorycache.go#L33-L38>)

Memory holds our cache

```go
type Memory struct {
    mutex    sync.RWMutex
    capacity int64
    store    map[uint64]item
    Config   memoryConfig
}
```

<a name="NewMemoryCache"></a>
### func [NewMemoryCache](<https://github.com/sphireinc/mantis/blob/master/cache/memorycache.go#L41>)

```go
func NewMemoryCache(capacity int64, expiry string) *Memory
```

NewMemoryCache creates and returns a new in memory cache

<a name="Memory.Get"></a>
### func \(\*Memory\) [Get](<https://github.com/sphireinc/mantis/blob/master/cache/memorycache.go#L58>)

```go
func (m *Memory) Get(key uint64) (any, bool)
```

Get the value associated with a key in our cache

<a name="Memory.Release"></a>
### func \(\*Memory\) [Release](<https://github.com/sphireinc/mantis/blob/master/cache/memorycache.go#L109>)

```go
func (m *Memory) Release(key uint64)
```

Release an item from our memory cache

<a name="Memory.Set"></a>
### func \(\*Memory\) [Set](<https://github.com/sphireinc/mantis/blob/master/cache/memorycache.go#L99>)

```go
func (m *Memory) Set(key uint64, value any, expiration time.Time)
```

Set a new kv pair in our memory cache

<a name="Memory.checkExpireAndUpdate"></a>
### func \(\*Memory\) [checkExpireAndUpdate](<https://github.com/sphireinc/mantis/blob/master/cache/memorycache.go#L73>)

```go
func (m *Memory) checkExpireAndUpdate(key uint64, toStore item) int
```

checkExpireAndUpdate checks if KV has expired, if not updates toStore item returns false if released, true if updated

<a name="Memory.evict"></a>
### func \(\*Memory\) [evict](<https://github.com/sphireinc/mantis/blob/master/cache/memorycache.go#L123>)

```go
func (m *Memory) evict()
```

evict records from memory on an LRU basis

<a name="Memory.triggerEvict"></a>
### func \(\*Memory\) [triggerEvict](<https://github.com/sphireinc/mantis/blob/master/cache/memorycache.go#L115>)

```go
func (m *Memory) triggerEvict()
```

triggerEvict checks if we need to evict data, and commences eviction if so

<a name="diskCache"></a>
## type [diskCache](<https://github.com/sphireinc/mantis/blob/master/cache/diskcache.go#L14-L17>)



```go
type diskCache struct {
    key      string
    filename string
}
```

<a name="item"></a>
## type [item](<https://github.com/sphireinc/mantis/blob/master/cache/memorycache.go#L20-L24>)

item is an item and its metadata in our cache

```go
type item struct {
    value        any
    lastAccessed time.Time
    expiration   time.Time
}
```

<a name="memoryConfig"></a>
## type [memoryConfig](<https://github.com/sphireinc/mantis/blob/master/cache/memorycache.go#L27-L30>)

memoryConfig holds our expiry configuration

```go
type memoryConfig struct {
    Expiry        time.Duration
    DefaultExpiry time.Duration
}
```

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
